{
  "hash": "7d0a4fb1eb9ca21a43c3ecfb680d8ff2",
  "result": {
    "markdown": "---\ntitle: \"Linear regression\"\nauthor: \"Tejaskumar Patel\"\ndate: \"2023-12-14\"\ncategories: [R, Regression, analysis]\nimage: \"image.jpg\"\n---\n\n\nHi, Let's run a regression.\n\n#### **Data Set Description**\n\n## **State-level Census data**\n\nWe have state level census data on various socio-economic and demographic factors called **mydata**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmydata <-read.csv(\"D://ADTA 5410 DEPLOYMENT//Portfolio//my portfolio//ADTATEJAS//posts//my first post//my portfolio data.csv\", head=T)\n\nnames(mydata)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"State\"                       \"OwnComputer\"                \n [3] \"CommutePublicTransport\"      \"TotalPopulation\"            \n [5] \"MedianAge\"                   \"WithCashAssistanceIncome\"   \n [7] \"MeanSocialSecurityIcnome\"    \"SupplementarySecurityIncome\"\n [9] \"WhiteOnly\"                   \"Latinos\"                    \n[11] \"Asians\"                      \"AfricanAmerican\"            \n[13] \"Income100K.150K\"             \"Income75K.100K\"             \n[15] \"Income50K.75K\"               \"Income35K.50K\"              \n[17] \"Income25K.35K\"               \"PovertyRate\"                \n```\n:::\n:::\n\n\n**Task 1:**\n\nIn this task, I will start by looking closely at the data to understand it better. Then, I \\'ll use a multiple linear regression to make predictions.\n\nThere are 52 observations and 18 variables in the data.\n\n1\\. **State**: This variable represents the name of each state in the dataset.\n\n2.**OwnComputer**: This variable represents the percentage of households in each state that own a computer, indicating the level of computer ownership.\n\n3. **CommutePublicTransport**: This variable represents the percentage of people in each state who use public transportation as their primary means of commuting to work or other places.\n\n4.**TotalPopulation**: This variable represents the total population of each state, indicating the number of people residing in that state.\n\n5.**MedianAge**: This variable represents the median age of the population in each state, providing an insight into the state\\'s demographic age distribution.\n\n6.**WithCashAssistanceIncome**: This variable represents the percentage of households or individuals in each state receiving cash assistance income, possibly from government programs.\n\n7.**MeanSocialSecurityIncome**: This variable represents the average or mean amount of Social Security income received by individuals in each state.\n\n8\\. **SupplementarySecurityIncome**: This variable represent the percentage of people in each state who receives supplementary security income related to social welfare programs.\n\n9\\. **WhiteOnly**: This variable represents the percentage of people in each state identifying as White or Caucasian in terms of racial or ethnic background.\n\n10\\. **Latinos**: This variable represents the percentage of people in each state identifying as Latino or Hispanic in terms of racial or ethnic background.\n\n11\\. **Asians**: This variable represents the percentage of people in each state identifying as Asian in terms of racial or ethnic background.\n\n12\\. **AfricanAmerican**: This variable represents the percentage of people in each state identifying as African American or Black in terms of racial or ethnic background.\n\n13\\. **Income100K.150K**: This variable represents the percentage or number of households in each state with an annual income falling within the range of \\$100,000 to \\$150,000.\n\n14\\. **Income75K.100K**: This variable represents the percentage of households in each state with an annual income falling within the range of \\$75,000 to \\$100,000.\n\n15\\. **Income50K.75K**: This variable represents the percentage of households in each state with an annual income falling within the range of \\$50,000 to \\$75,000.\n\n16\\. **Income35K.50K**: This variable represents the percentage of households in each state with an annual income falling within the range of \\$35,000 to \\$50,000.\n\n17\\. **Income25K.35K**: This variable represents the percentage of households in each state with an annual income falling within the range of \\$25,000 to \\$35,000.\n\n18\\. **PovertyRate**: This variable represents the poverty rate in each state, indicating the percentage of the population living below the poverty line or threshold.\n\nHere, my target variable is commuters\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a copy of mydata and call it dataUS\ndataUS <- mydata\n\n# Calculate the commuters variable\ndataUS$commuters <- 100 * dataUS$CommutePublicTransport / dataUS$TotalPopulation\n\n# Remove the CommutePublicTransport and TotalPopulation variables\ndataUS <- dataUS[, !(names(dataUS) %in% c(\"CommutePublicTransport\", \"TotalPopulation\"))]\n\n# Identify the three states with the highest values of commuters\ntop_states <- dataUS[order(dataUS$commuters,decreasing = TRUE), ][1:3, \"State\"]\n\n# Identify the three states with the lowest values of commuters\nbottom_states <- dataUS[order(dataUS$commuters), ][1:3, \"State\"]\n\n# Print the results\ncat(\"Three states with the highest values of commuters:\", top_states, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nThree states with the highest values of commuters: District of Columbia New York New Jersey \n```\n:::\n:::\n\n\n**Task 2:**\n\nHere, I will Generate a scatter plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\n# Remove the 'State' column\ndataUS <- select(dataUS, -State)\n\n# Calculate correlations\ncorrelations <- cor(dataUS, use = \"complete.obs\")\n\n# Create a dataframe with correlations with 'commuters'\ncor_with_commuters <- data.frame(Variable = row.names(correlations), Correlation = correlations[, \"commuters\"])\n\n# Sort by absolute correlation values\ncor_with_commuters <- cor_with_commuters[order(abs(cor_with_commuters$Correlation), decreasing = TRUE), ]\n\n# Get the variable with the highest absolute correlation\nhighest_corr_var <- cor_with_commuters$Variable[1]\n\n# Generate the scatter plot\nggplot(dataUS, aes_string(x = highest_corr_var, y = \"commuters\")) +\n  geom_point(aes(color = OwnComputer < 88)) +\n  labs(x = highest_corr_var, y = \"Commuters\") +\n  scale_color_discrete(name = \"OwnComputer < 88\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: `aes_string()` was deprecated in ggplot2 3.0.0.\nℹ Please use tidy evaluation idioms with `aes()`.\nℹ See also `vignette(\"ggplot2-in-packages\")` for more information.\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n**Task 3:**\n\nHere, I will Create a scatterplot that displays the relationship between residuals and fitted values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\n# Assuming your dataset is named 'dataUS', replace with your actual dataset name\n# Fit the linear regression model with specified predictors\nmodel1 <- lm(commuters ~ MedianAge + Income100K.150K + Income35K.50K + PovertyRate, data = dataUS)\n\n# Interpretation of coefficient estimates excluding the intercept\ncoef_summary <- summary(model1)$coefficients\ninterpretations <- paste(\n  \"MedianAge:\", round(coef_summary[\"MedianAge\", \"Estimate\"], 4),\n  \"Income100K.150K:\", round(coef_summary[\"Income100K.150K\", \"Estimate\"], 4),\n  \"Income35K.50K:\", round(coef_summary[\"Income35K.50K\", \"Estimate\"], 4),\n  \"PovertyRate:\", round(coef_summary[\"PovertyRate\", \"Estimate\"], 4)\n)\n\n# Print one-sentence interpretations\ninterpretations\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"MedianAge: -0.8853 Income100K.150K: -4.5123 Income35K.50K: -6.2855 PovertyRate: -1.8438\"\n```\n:::\n\n```{.r .cell-code}\n# Create a scatterplot of residuals vs. fitted values\nresidual_plot <- ggplot(data = data.frame(Fitted = fitted(model1), Residuals = residuals(model1)), aes(x = Fitted, y = Residuals)) +\n  geom_point() +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"red\") +\n  labs(x = \"Fitted Values\", y = \"Residuals\") +\n  ggtitle(\"Residuals vs. Fitted Values\")\n\n# Display the scatterplot\nprint(residual_plot)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}